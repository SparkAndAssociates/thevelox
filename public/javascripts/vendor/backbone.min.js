(function(){var l;if(typeof exports!=="undefined"){l=exports}else{l=this.Backbone={}}l.VERSION="0.3.3";var n=this._;if(!n&&(typeof require!=="undefined")){n=require("underscore")._}var e=this.jQuery||this.Zepto;l.emulateHTTP=false;l.emulateJSON=false;l.Events={bind:function(s,u){var r=this._callbacks||(this._callbacks={});var t=this._callbacks[s]||(this._callbacks[s]=[]);t.push(u);return this},unbind:function(u,w){var t;if(!u){this._callbacks={}}else{if(t=this._callbacks){if(!w){t[u]=[]}else{var v=t[u];if(!v){return this}for(var s=0,r=v.length;s<r;s++){if(w===v[s]){v.splice(s,1);break}}}}}return this},trigger:function(u){var v,t,s,r;if(!(t=this._callbacks)){return this}if(v=t[u]){for(s=0,r=v.length;s<r;s++){v[s].apply(this,Array.prototype.slice.call(arguments,1))}}if(v=t.all){for(s=0,r=v.length;s<r;s++){v[s].apply(this,arguments)}}return this}};l.Model=function(r,s){r||(r={});if(this.defaults){r=n.extend({},this.defaults,r)}this.attributes={};this._escapedAttributes={};this.cid=n.uniqueId("c");this.set(r,{silent:true});this._previousAttributes=n.clone(this.attributes);if(s&&s.collection){this.collection=s.collection}this.initialize(r,s)};n.extend(l.Model.prototype,l.Events,{_previousAttributes:null,_changed:false,initialize:function(){},toJSON:function(){return n.clone(this.attributes)},get:function(r){return this.attributes[r]},escape:function(r){var s;if(s=this._escapedAttributes[r]){return s}var t=this.attributes[r];return this._escapedAttributes[r]=p(t==null?"":t)},set:function(u,t){t||(t={});if(!u){return this}if(u.attributes){u=u.attributes}var s=this.attributes,v=this._escapedAttributes;if(!t.silent&&this.validate&&!this._performValidation(u,t)){return false}if("id" in u){this.id=u.id}for(var r in u){var w=u[r];if(!n.isEqual(s[r],w)){s[r]=w;delete v[r];if(!t.silent){this._changed=true;this.trigger("change:"+r,this,w,t)}}}if(!t.silent&&this._changed){this.change(t)}return this},unset:function(r,s){s||(s={});var u=this.attributes[r];var t={};t[r]=void 0;if(!s.silent&&this.validate&&!this._performValidation(t,s)){return false}delete this.attributes[r];delete this._escapedAttributes[r];if(!s.silent){this._changed=true;this.trigger("change:"+r,this,void 0,s);this.change(s)}return this},clear:function(s){s||(s={});var r=this.attributes;var t={};for(attr in r){t[attr]=void 0}if(!s.silent&&this.validate&&!this._performValidation(t,s)){return false}this.attributes={};this._escapedAttributes={};if(!s.silent){this._changed=true;for(attr in r){this.trigger("change:"+attr,this,void 0,s)}this.change(s)}return this},fetch:function(t){t||(t={});var s=this;var u=function(v){if(!s.set(s.parse(v),t)){return false}if(t.success){t.success(s,v)}};var r=d(t.error,s,t);(this.sync||l.sync)("read",this,u,r);return this},save:function(u,t){t||(t={});if(u&&!this.set(u,t)){return false}var s=this;var v=function(x){if(!s.set(s.parse(x),t)){return false}if(t.success){t.success(s,x)}};var r=d(t.error,s,t);var w=this.isNew()?"create":"update";(this.sync||l.sync)(w,this,v,r);return this},destroy:function(t){t||(t={});var s=this;var u=function(v){if(s.collection){s.collection.remove(s)}if(t.success){t.success(s,v)}};var r=d(t.error,s,t);(this.sync||l.sync)("delete",this,u,r);return this},url:function(){var r=h(this.collection);if(this.isNew()){return r}return r+(r.charAt(r.length-1)=="/"?"":"/")+this.id},parse:function(r){return r},clone:function(){return new this.constructor(this)},isNew:function(){return !this.id},change:function(r){this.trigger("change",this,r);this._previousAttributes=n.clone(this.attributes);this._changed=false},hasChanged:function(r){if(r){return this._previousAttributes[r]!=this.attributes[r]}return this._changed},changedAttributes:function(t){t||(t=this.attributes);var s=this._previousAttributes;var u=false;for(var r in t){if(!n.isEqual(s[r],t[r])){u=u||{};u[r]=t[r]}}return u},previous:function(r){if(!r||!this._previousAttributes){return null}return this._previousAttributes[r]},previousAttributes:function(){return n.clone(this._previousAttributes)},_performValidation:function(t,s){var r=this.validate(t);if(r){if(s.error){s.error(this,r)}else{this.trigger("error",this,r,s)}return false}return true}});l.Collection=function(s,r){r||(r={});if(r.comparator){this.comparator=r.comparator;delete r.comparator}this._boundOnModelEvent=n.bind(this._onModelEvent,this);this._reset();if(s){this.refresh(s,{silent:true})}this.initialize(s,r)};n.extend(l.Collection.prototype,l.Events,{model:l.Model,initialize:function(){},toJSON:function(){return this.map(function(r){return r.toJSON()})},add:function(u,s){if(n.isArray(u)){for(var t=0,r=u.length;t<r;t++){this._add(u[t],s)}}else{this._add(u,s)}return this},remove:function(u,s){if(n.isArray(u)){for(var t=0,r=u.length;t<r;t++){this._remove(u[t],s)}}else{this._remove(u,s)}return this},get:function(r){if(r==null){return null}return this._byId[r.id!=null?r.id:r]},getByCid:function(r){return r&&this._byCid[r.cid||r]},at:function(r){return this.models[r]},sort:function(r){r||(r={});if(!this.comparator){throw new Error("Cannot sort a set without a comparator")}this.models=this.sortBy(this.comparator);if(!r.silent){this.trigger("refresh",this,r)}return this},pluck:function(r){return n.map(this.models,function(s){return s.get(r)})},refresh:function(s,r){s||(s=[]);r||(r={});this._reset();this.add(s,{silent:true});if(!r.silent){this.trigger("refresh",this,r)}return this},fetch:function(s){s||(s={});var u=this;var t=function(v){u.refresh(u.parse(v));if(s.success){s.success(u,v)}};var r=d(s.error,u,s);(this.sync||l.sync)("read",this,t,r);return this},create:function(s,r){var t=this;r||(r={});if(!(s instanceof l.Model)){s=new this.model(s,{collection:t})}else{s.collection=t}var u=function(v,w){t.add(v);if(r.success){r.success(v,w)}};return s.save(null,{success:u,error:r.error})},parse:function(r){return r},chain:function(){return n(this.models).chain()},_reset:function(r){this.length=0;this.models=[];this._byId={};this._byCid={}},_add:function(t,s){s||(s={});if(!(t instanceof l.Model)){t=new this.model(t,{collection:this})}var u=this.getByCid(t);if(u){throw new Error(["Can't add the same model to a set twice",u.id])}this._byId[t.id]=t;this._byCid[t.cid]=t;t.collection=this;var r=this.comparator?this.sortedIndex(t,this.comparator):this.length;this.models.splice(r,0,t);t.bind("all",this._boundOnModelEvent);this.length++;if(!s.silent){t.trigger("add",t,this,s)}return t},_remove:function(s,r){r||(r={});s=this.getByCid(s)||this.get(s);if(!s){return null}delete this._byId[s.id];delete this._byCid[s.cid];delete s.collection;this.models.splice(this.indexOf(s),1);this.length--;if(!r.silent){s.trigger("remove",s,this,r)}s.unbind("all",this._boundOnModelEvent);return s},_onModelEvent:function(s,r){if(s==="change:id"){delete this._byId[r.previous("id")];this._byId[r.id]=r}this.trigger.apply(this,arguments)}});var c=["forEach","each","map","reduce","reduceRight","find","detect","filter","select","reject","every","all","some","any","include","invoke","max","min","sortBy","sortedIndex","toArray","size","first","rest","last","without","indexOf","lastIndexOf","isEmpty"];n.each(c,function(r){l.Collection.prototype[r]=function(){return n[r].apply(n,[this.models].concat(n.toArray(arguments)))}});l.Controller=function(r){r||(r={});if(r.routes){this.routes=r.routes}this._bindRoutes();this.initialize(r)};var q=/:([\w\d]+)/g;var f=/\*([\w\d]+)/g;n.extend(l.Controller.prototype,l.Events,{initialize:function(){},route:function(r,s,t){l.history||(l.history=new l.History);if(!n.isRegExp(r)){r=this._routeToRegExp(r)}l.history.route(r,n.bind(function(v){var u=this._extractParameters(r,v);t.apply(this,u);this.trigger.apply(this,["route:"+s].concat(u))},this))},saveLocation:function(r){l.history.saveLocation(r)},_bindRoutes:function(){if(!this.routes){return}for(var r in this.routes){var s=this.routes[r];this.route(r,s,this[s])}},_routeToRegExp:function(r){r=r.replace(q,"([^/]*)").replace(f,"(.*?)");return new RegExp("^"+r+"$")},_extractParameters:function(r,s){return r.exec(s).slice(1)}});l.History=function(){this.handlers=[];this.fragment=this.getFragment();n.bindAll(this,"checkUrl")};var m=/^#*/;n.extend(l.History.prototype,{interval:50,getFragment:function(r){return(r||window.location).hash.replace(m,"")},start:function(){var r=document.documentMode;var s=(e.browser.msie&&(!r||r<=7));if(s){this.iframe=e('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow}if("onhashchange" in window&&!s){e(window).bind("hashchange",this.checkUrl)}else{setInterval(this.checkUrl,this.interval)}return this.loadUrl()},route:function(r,s){this.handlers.push({route:r,callback:s})},checkUrl:function(){var r=this.getFragment();if(r==this.fragment&&this.iframe){r=this.getFragment(this.iframe.location)}if(r==this.fragment||r==decodeURIComponent(this.fragment)){return false}if(this.iframe){window.location.hash=this.iframe.location.hash=r}this.loadUrl()},loadUrl:function(){var s=this.fragment=this.getFragment();var r=n.any(this.handlers,function(t){if(t.route.test(s)){t.callback(s);return true}});return r},saveLocation:function(r){r=(r||"").replace(m,"");if(this.fragment==r){return}window.location.hash=this.fragment=r;if(this.iframe&&(r!=this.getFragment(this.iframe.location))){this.iframe.document.open().close();this.iframe.location.hash=r}}});l.View=function(r){this._configure(r||{});this._ensureElement();this.delegateEvents();this.initialize(r)};var a=function(r){return e(r,this.el)};var o=/^(\w+)\s*(.*)$/;n.extend(l.View.prototype,l.Events,{tagName:"div",$:a,initialize:function(){},render:function(){return this},remove:function(){e(this.el).remove();return this},make:function(s,r,u){var t=document.createElement(s);if(r){e(t).attr(r)}if(u){e(t).html(u)}return t},delegateEvents:function(w){if(!(w||(w=this.events))){return}e(this.el).unbind();for(var v in w){var t=w[v];var u=v.match(o);var s=u[1],r=u[2];var x=n.bind(this[t],this);if(r===""){e(this.el).bind(s,x)}else{e(this.el).delegate(r,s,x)}}},_configure:function(r){if(this.options){r=n.extend({},this.options,r)}if(r.model){this.model=r.model}if(r.collection){this.collection=r.collection}if(r.el){this.el=r.el}if(r.id){this.id=r.id}if(r.className){this.className=r.className}if(r.tagName){this.tagName=r.tagName}this.options=r},_ensureElement:function(){if(this.el){return}var r={};if(this.id){r.id=this.id}if(this.className){r["class"]=this.className}this.el=this.make(this.tagName,r)}});var g=function(r,s){var t=j(this,r,s);t.extend=g;return t};l.Model.extend=l.Collection.extend=l.Controller.extend=l.View.extend=g;var b={create:"POST",update:"PUT","delete":"DELETE",read:"GET"};l.sync=function(x,s,v,r){var t=b[x];var w=(x==="create"||x==="update")?JSON.stringify(s.toJSON()):null;var u={url:h(s),type:t,contentType:"application/json",data:w,dataType:"json",processData:false,success:v,error:r};if(l.emulateJSON){u.contentType="application/x-www-form-urlencoded";u.processData=true;u.data=w?{model:w}:{}}if(l.emulateHTTP){if(t==="PUT"||t==="DELETE"){if(l.emulateJSON){u.data._method=t}u.type="POST";u.beforeSend=function(y){y.setRequestHeader("X-HTTP-Method-Override",t)}}}e.ajax(u)};var k=function(){};var j=function(s,r,t){var u;if(r&&r.hasOwnProperty("constructor")){u=r.constructor}else{u=function(){return s.apply(this,arguments)}}k.prototype=s.prototype;u.prototype=new k();if(r){n.extend(u.prototype,r)}if(t){n.extend(u,t)}u.prototype.constructor=u;u.__super__=s.prototype;return u};var h=function(r){if(!(r&&r.url)){throw new Error("A 'url' property or function must be specified")}return n.isFunction(r.url)?r.url():r.url};var d=function(t,s,r){return function(u){if(t){t(s,u)}else{s.trigger("error",s,u,r)}}};var p=function(r){return r.replace(/&(?!\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}})();var FlashDetect=new function(){var a=this;a.installed=false;a.raw="";a.major=-1;a.minor=-1;a.revision=-1;a.revisionStr="";var b=[{name:"ShockwaveFlash.ShockwaveFlash.7",version:function(h){return d(h)}},{name:"ShockwaveFlash.ShockwaveFlash.6",version:function(k){var h="6,0,21";try{k.AllowScriptAccess="always";h=d(k)}catch(j){}return h}},{name:"ShockwaveFlash.ShockwaveFlash",version:function(h){return d(h)}}];var d=function(k){var h=-1;try{h=k.GetVariable("$version")}catch(j){}return h};var g=function(h){var k=-1;try{k=new ActiveXObject(h)}catch(j){k={activeXError:true}}return k};var c=function(j){var h=j.split(",");return{raw:j,major:parseInt(h[0].split(" ")[1],10),minor:parseInt(h[1],10),revision:parseInt(h[2],10),revisionStr:h[2]}};var f=function(l){var j=l.split(/ +/);var k=j[2].split(/\./);var h=j[3];return{raw:l,major:parseInt(k[0],10),minor:parseInt(k[1],10),revisionStr:h,revision:e(h)}};var e=function(h){return parseInt(h.replace(/[a-zA-Z]/g,""),10)||a.revision};a.majorAtLeast=function(h){return a.major>=h};a.minorAtLeast=function(h){return a.minor>=h};a.revisionAtLeast=function(h){return a.revision>=h};a.versionAtLeast=function(j){var k=[a.major,a.minor,a.revision];var h=Math.min(k.length,arguments.length);for(i=0;i<h;i++){if(k[i]>=arguments[i]){if(i+1<h&&k[i]==arguments[i]){continue}else{return true}}else{return false}}};a.FlashDetect=function(){if(navigator.plugins&&navigator.plugins.length>0){var l="application/x-shockwave-flash";var k=navigator.mimeTypes;if(k&&k[l]&&k[l].enabledPlugin&&k[l].enabledPlugin.description){var h=k[l].enabledPlugin.description;var m=f(h);a.raw=m.raw;a.major=m.major;a.minor=m.minor;a.revisionStr=m.revisionStr;a.revision=m.revision;a.installed=true}}else{if(navigator.appVersion.indexOf("Mac")==-1&&window.execScript){var h=-1;for(var j=0;j<b.length&&h==-1;j++){var n=g(b[j].name);if(!n.activeXError){a.installed=true;h=b[j].version(n);if(h!=-1){var m=c(h);a.raw=m.raw;a.major=m.major;a.minor=m.minor;a.revision=m.revision;a.revisionStr=m.revisionStr}}}}}}()};FlashDetect.JS_RELEASE="1.0.4";(function(b){function a(d,c){this.$element=b(d);this.options=c;this.enabled=true;this.fixTitle()}a.prototype={show:function(){var f=this.getTitle();if(f&&this.enabled){var e=this.tip();e.find(".tipsy-inner")[this.options.html?"html":"text"](f);e[0].className="tipsy";e.remove().css({top:0,left:0,visibility:"hidden",display:"block"}).appendTo(document.body);var j=b.extend({},this.$element.offset(),{width:this.$element[0].offsetWidth,height:this.$element[0].offsetHeight});var c=e[0].offsetWidth,h=e[0].offsetHeight;var g=(typeof this.options.gravity=="function")?this.options.gravity.call(this.$element[0]):this.options.gravity;var d;switch(g.charAt(0)){case"n":d={top:j.top+j.height+this.options.offset,left:j.left+j.width/2-c/2};break;case"s":d={top:j.top-h-this.options.offset,left:j.left+j.width/2-c/2};break;case"e":d={top:j.top+j.height/2-h/2,left:j.left-c-this.options.offset};break;case"w":d={top:j.top+j.height/2-h/2,left:j.left+j.width+this.options.offset};break}if(g.length==2){if(g.charAt(1)=="w"){d.left=j.left+j.width/2-15}else{d.left=j.left+j.width/2-c+15}}e.css(d).addClass("tipsy-"+g);if(this.options.fade){e.stop().css({opacity:0,display:"block",visibility:"visible"}).animate({opacity:this.options.opacity})}else{e.css({visibility:"visible",opacity:this.options.opacity})}}},hide:function(){if(this.options.fade){this.tip().stop().fadeOut(function(){b(this).remove()})}else{this.tip().remove()}},fixTitle:function(){var c=this.$element;if(c.attr("title")||typeof(c.attr("original-title"))!="string"){c.attr("original-title",c.attr("title")||"").removeAttr("title")}},getTitle:function(){var e,c=this.$element,d=this.options;this.fixTitle();var e,d=this.options;if(typeof d.title=="string"){e=c.attr(d.title=="title"?"original-title":d.title)}else{if(typeof d.title=="function"){e=d.title.call(c[0])}}e=(""+e).replace(/(^\s*|\s*$)/,"");return e||d.fallback},tip:function(){if(!this.$tip){this.$tip=b('<div class="tipsy"></div>').html('<div class="tipsy-arrow"></div><div class="tipsy-inner"></div>')}return this.$tip},validate:function(){if(!this.$element[0].parentNode){this.hide();this.$element=null;this.options=null}},enable:function(){this.enabled=true},disable:function(){this.enabled=false},toggleEnabled:function(){this.enabled=!this.enabled}};b.fn.tipsy=function(g){if(g===true){return this.data("tipsy")}else{if(typeof g=="string"){var j=this.data("tipsy");if(j){j[g]()}return this}}g=b.extend({},b.fn.tipsy.defaults,g);function f(l){var m=b.data(l,"tipsy");if(!m){m=new a(l,b.fn.tipsy.elementOptions(l,g));b.data(l,"tipsy",m)}return m}function k(){var l=f(this);l.hoverState="in";if(g.delayIn==0){l.show()}else{l.fixTitle();setTimeout(function(){if(l.hoverState=="in"){l.show()}},g.delayIn)}}function e(){var l=f(this);l.hoverState="out";if(g.delayOut==0){l.hide()}else{setTimeout(function(){if(l.hoverState=="out"){l.hide()}},g.delayOut)}}if(!g.live){this.each(function(){f(this)})}if(g.trigger!="manual"){var c=g.live?"live":"bind",h=g.trigger=="hover"?"mouseenter":"focus",d=g.trigger=="hover"?"mouseleave":"blur";this[c](h,k)[c](d,e)}return this};b.fn.tipsy.defaults={delayIn:0,delayOut:0,fade:false,fallback:"",gravity:"n",html:false,live:false,offset:0,opacity:0.8,title:"title",trigger:"hover"};b.fn.tipsy.elementOptions=function(d,c){return b.metadata?b.extend({},c,b(d).metadata()):c};b.fn.tipsy.autoNS=function(){return b(this).offset().top>(b(document).scrollTop()+b(window).height()/2)?"s":"n"};b.fn.tipsy.autoWE=function(){return b(this).offset().left>(b(document).scrollLeft()+b(window).width()/2)?"e":"w"}})(jQuery);